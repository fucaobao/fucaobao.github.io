webpackJsonp([1],{"1BdF":function(t,e){},CTeu:function(t,e,s){"use strict";var i=s("Dd8w"),a=s.n(i),c=s("3Q4o"),o={data:function(){return{count:0,checked:!1,showIcon:!1,isManualCount:!1}},props:{hasCheckBox:{type:Boolean,default:!1},item:{type:Object,default:function(){return{}}}},methods:{minus:function(){this.isManualCount=!1,this.count=Math.max(0,parseInt(this.count-1)||0)},plus:function(){this.isManualCount=!1,this.count=(parseInt(this.count)||0)+1},setCount:function(t){this.isManualCount=!0,this.count=t},setChecked:function(t){this.checked=t},toggleItem:function(){var t=this.$refs.checkbox;Object(c.b)(t,"active")?this.checked=!1:this.checked=!0}},watch:{count:function(t){this.showIcon=0!==t,this.isManualCount||this.$emit("count",a()({},this.item,{count:""===t?0:isFinite(t)?parseInt(t):0,_trueValue_:t}))},checked:function(t){this.$emit("checked",t,this.item)}},components:{}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"good"},[t.hasCheckBox?s("div",{staticClass:"left",on:{click:t.toggleItem}},[s("i",{ref:"checkbox",class:!0===t.checked?"active":""})]):t._e(),t._v(" "),s("div",{staticClass:"middle"},[s("img",{staticClass:"img",attrs:{src:t.item.imageUrl}})]),t._v(" "),s("div",{staticClass:"right"},[s("p",{staticClass:"name"},[t._v(t._s(t.item.title))]),t._v(" "),s("div",{staticClass:"main"},[s("div",{staticClass:"desc"},[s("p",{staticClass:"size"},[s("label",[t._v("规格：")]),t._v(" "),s("span",[t._v(t._s(t.item.desc))])]),t._v(" "),s("p",{staticClass:"price"},[s("label",[t._v("￥")]),t._v(" "),s("span",[t._v(t._s(t._f("formatMoney")(t.item.price)))]),t._v(" "),s("label",[t._v("/"+t._s(t.item.unit))])])]),t._v(" "),s("div",{staticClass:"operate"},[s("i",{directives:[{name:"show",rawName:"v-show",value:t.showIcon,expression:"showIcon"}],staticClass:"minus",on:{click:t.minus}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showIcon,expression:"showIcon"}],staticClass:"input-wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.count,expression:"count"}],attrs:{type:"text"},domProps:{value:t.count},on:{input:function(e){e.target.composing||(t.count=e.target.value)}}})]),t._v(" "),s("i",{staticClass:"plus",on:{click:t.plus}})])])])])},staticRenderFns:[]};var r=s("VU/8")(o,n,!1,function(t){s("xZi1")},"data-v-51035f20",null);e.a=r.exports},XEAW:function(t,e,s){"use strict";var i={props:{cancelBtnText:{type:String,default:"取消"},confirmBtnText:{type:String,default:"确定"},message:{type:String,default:"错误"}},data:function(){return{showFlag:!1}},methods:{show:function(){this.showFlag=!0},hide:function(){this.showFlag=!1},cancel:function(){this.hide(),this.$emit("cancel")},confirm:function(){this.hide(),this.$emit("confirm")}},components:{}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],staticClass:"confirm-wrapper",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"alert"},[s("p",{staticClass:"close"},[s("i",{on:{click:t.hide}})]),t._v(" "),s("div",{staticClass:"message",domProps:{innerHTML:t._s(t.message)}}),t._v(" "),s("div",{staticClass:"operate-btn"},[s("span",{staticClass:"btn cancel",on:{click:t.cancel}},[t._v(t._s(t.cancelBtnText))]),t._v(" "),s("span",{staticClass:"btn confirm",on:{click:t.confirm}},[t._v(t._s(t.confirmBtnText))])])])])},staticRenderFns:[]};var c=s("VU/8")(i,a,!1,function(t){s("hs1d")},"data-v-160cc778",null);e.a=c.exports},hs1d:function(t,e){},i6in:function(t,e){},k9v5:function(t,e){},ppph:function(t,e){},xZi1:function(t,e){},zH0q:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Dd8w"),a=s.n(i),c=s("CTeu"),o=s("qwAB"),n=s("2X+S"),r=s("Csq2"),l=s("XEAW"),u={data:function(){return{}},props:{list:{type:Array,default:[]},title:{type:String,default:"历史记录"}},methods:{selectItem:function(t){this.$emit("query",t)},clearHistory:function(){this.$emit("clear")}},components:{}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"history-wrapper"},[s("div",{staticClass:"tilte"},[s("span",[t._v(t._s(t.title))]),t._v(" "),s("i",{on:{click:t.clearHistory}})]),t._v(" "),s("ul",{staticClass:"word-wrapper"},t._l(t.list,function(e,i){return s("li",{staticClass:"item",on:{click:function(s){t.selectItem(e)}}},[t._v("\n          "+t._s(e)+"\n      ")])}))])},staticRenderFns:[]};var d=s("VU/8")(u,h,!1,function(t){s("i6in")},"data-v-704c1f9f",null).exports,v=s("NYxO"),p=s("T452"),f=s("cJyC"),m={data:function(){return{query:"",productList:[],selectedGoods:{},total:0,price:0,confirmMessage:""}},props:{isShowSearch:{type:Boolean,default:!1}},computed:a()({currentRoute:function(){return this.$router.currentRoute.path}},Object(v.c)(["searchHistory"])),methods:a()({back:function(){this.$refs.searchBox.setQuery(""),this.productList=[],this.selectedGoods={},this.total=0,this.price=0,this.$emit("hide")},focus:function(){},showConfirm:function(){this.$refs.confirm.show()},clearHistory:function(){this.confirmMessage="确认删除搜索历史记录么？",this.showConfirm()},onQueryChange:function(t){var e=this.$refs.goodItem;if(e&&e.length)for(var s=0;s<e.length;s++)e[s].setCount(0);this.query=t,this.$refs.searchBox.setQuery(t)},_getProductList:function(){var t=this;Object(f.l)().then(function(e){e.errCode===p.b&&(t.productList=e.data)})},calc:function(t){var e=this;Object(f.b)({productItemId:t.productItemId,count:t.count}).then(function(s){if(s.errCode===p.b){e.selectedGoods[t.productItemId]=t;var i=0,a=0;for(var c in e.selectedGoods){var o=e.selectedGoods[c];i+=o.count,a+=o.price*o.count}e.total=i,e.price=a,e.item=t}})},submit:function(){this.setShoppingCart(this.selectedGoods),this.$router.push({path:this.currentRoute+"/shoppingcart"})}},Object(v.b)(["setShoppingCart","setSearchHistory","clearSearchHistory"])),watch:{query:function(t){this.setSearchHistory(t),this._getProductList()}},components:{SearchBox:n.a,History:d,Confirm:l.a,Settle:r.a,GoodItem:c.a,Scroll:o.a}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSearch,expression:"isShowSearch"}],staticClass:"wrapper"},[s("div",{staticClass:"header"},[s("div",{staticClass:"icon-wrapper"},[s("i",{staticClass:"back",on:{click:t.back}})]),t._v(" "),s("div",{staticClass:"search-box"},[s("search-box",{ref:"searchBox",attrs:{placeholder:"请输入商品名称"},on:{query:t.onQueryChange,focus:t.focus}})],1),t._v(" "),s("div",{staticClass:"text-wrapper",on:{click:t.back}},[s("span",[t._v("取消")])])]),t._v(" "),s("div",{staticClass:"content-wrapper"},[s("history",{directives:[{name:"show",rawName:"v-show",value:!t.productList.length&&t.searchHistory.length,expression:"!productList.length && searchHistory.length"}],attrs:{list:t.searchHistory},on:{query:t.onQueryChange,clear:t.clearHistory}}),t._v(" "),s("scroll",{directives:[{name:"show",rawName:"v-show",value:t.productList.length,expression:"productList.length"}],staticClass:"content"},[s("div",{staticClass:"list"},t._l(t.productList,function(e,i){return s("good-item",{key:e.productItemId,ref:"goodItem",refInFor:!0,staticClass:"item",attrs:{item:e},on:{count:t.calc}})}))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total,expression:"total"}],staticClass:"settle-wrapper"},[s("settle",{attrs:{price:t.price,total:t.total},on:{submit:t.submit}})],1)],1),t._v(" "),s("confirm",{ref:"confirm",attrs:{message:t.confirmMessage},on:{confirm:t.clearSearchHistory}})],1)},staticRenderFns:[]};var g=s("VU/8")(m,C,!1,function(t){s("k9v5")},"data-v-488d9726",null).exports,_=s("3Q4o"),w={data:function(){return{query:"",productCatelog:[]}},created:function(){this._getProductCatelog()},methods:{back:function(){this.$emit("hide")},confirm:function(){this.$emit("query",this.query),this.back()},toggle:function(t){var e=t.srcElement||t.target,s=Object(_.b)(e,"title")?e:e.parentNode;Object(_.b)(s,"active")?Object(_.c)(s,"active"):Object(_.a)(s,"active");var i=s.nextElementSibling;Object(_.b)(i,"hide")?Object(_.c)(i,"hide"):Object(_.a)(i,"hide")},select:function(t){for(var e=t.srcElement||t.target,s=this.$refs.item,i=0;i<s.length;i++){var a=s[i];Object(_.b)(a,"active")&&Object(_.c)(a,"active")}Object(_.a)(e,"active"),this.query=e.innerText;var c=e.parentNode;Object(_.c)(c,"hide")},_getProductCatelog:function(){var t=this;Object(f.k)().then(function(e){e.errCode===p.b&&(t.productCatelog=t.normalize(e.data))})},normalize:function(t){for(var e=[],s=0;s<t.length;s++){var i=t[s];null==i.parentId&&e.push(a()({},i,{list:[]}))}for(var c=0;c<e.length;c++)for(var o=0;o<t.length;o++){var n=t[o];e[c].id===n.parentId&&e[c].list.push(n)}return e}},components:{Scroll:o.a}},y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"category-wrapper"},[s("div",{staticClass:"dialog"},[s("div",{staticClass:"header"},[s("div",{staticClass:"icon-wrapper"},[s("i",{staticClass:"back",on:{click:t.back}})]),t._v(" "),s("div",{staticClass:"text"},[t._v("\n        全部分类\n      ")]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"content-wrapper"},[s("scroll",{staticClass:"content"},[s("ul",{staticClass:"list"},t._l(t.productCatelog,function(e,i){return s("li",{staticClass:"parent"},[s("div",{staticClass:"title",on:{click:t.toggle}},[s("span",{staticClass:"text"},[t._v(t._s(e.name))]),t._v(" "),s("i")]),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:e.list&&e.list.length,expression:"item.list && item.list.length"}],staticClass:"detail hide"},t._l(e.list,function(e){return s("li",{ref:"item",refInFor:!0,staticClass:"item",on:{click:function(e){e.stopPropagation(),t.select(e)}}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))])}))])],1),t._v(" "),s("div",{staticClass:"footer"},[s("span",{staticClass:"cancel",on:{click:t.back}},[t._v("取消")]),t._v(" "),s("span",{staticClass:"confirm",on:{click:t.confirm}},[t._v("确定")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"icon-wrapper"},[e("i",{staticClass:"icon-category"})])}]};var b=s("VU/8")(w,y,!1,function(t){s("1BdF")},"data-v-2862a25d",null).exports,k={data:function(){return{query:"",productList:[],isShowSearch:!1,isShowCategory:!1,selectedGoods:{},total:0,price:0}},created:function(){this._getProductList()},computed:a()({currentRoute:function(){return this.$router.currentRoute.path}},Object(v.c)(["searchHistory"])),methods:a()({back:function(){this.$router.back()},showSearch:function(){this.isShowSearch=!0},hideSearch:function(){this.isShowSearch=!1},showCategory:function(){this.isShowCategory=!0},hideCategory:function(){this.isShowCategory=!1},onQueryChange:function(t){var e=this.$refs.goodItem;if(e)for(var s=0;s<e.length;s++)e[s].setCount(0);this.query=t,this.$refs.searchBox.setQuery(t)},_getProductList:function(){var t=this;Object(f.l)().then(function(e){e.errCode===p.b&&(t.productList=e.data)})},calc:function(t){var e=this;Object(f.b)({productItemId:t.productItemId,count:t.count}).then(function(s){if(s.errCode===p.b){e.selectedGoods[t.productItemId]=t;var i=0,a=0;for(var c in e.selectedGoods){var o=e.selectedGoods[c];i+=o.count,a+=o.price*o.count}e.total=i,e.price=a,e.item=t}})},submit:function(){this.setShoppingCart(this.selectedGoods),this.$router.push({path:this.currentRoute+"/shoppingcart"})}},Object(v.b)(["setShoppingCart","setSearchHistory"])),watch:{query:function(t){this.setSearchHistory(t),this._getProductList()}},components:{SearchBox:n.a,Search:g,Settle:r.a,GoodItem:c.a,Scroll:o.a,Category:b}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"slide"}},[s("div",{staticClass:"wrapper"},[s("div",{staticClass:"header"},[s("div",{staticClass:"icon-wrapper"},[s("i",{staticClass:"back",on:{click:t.back}})]),t._v(" "),s("div",{staticClass:"search-box"},[s("search-box",{ref:"searchBox",on:{query:t.onQueryChange,focus:t.showSearch}})],1),t._v(" "),s("div",{staticClass:"icon-wrapper"},[s("i",{staticClass:"icon-category",on:{click:t.showCategory}})])]),t._v(" "),s("div",{staticClass:"content-wrapper"},[s("scroll",{staticClass:"content"},[s("div",{staticClass:"list"},t._l(t.productList,function(e,i){return s("good-item",{key:e.productItemId,ref:"goodItem",refInFor:!0,staticClass:"item",attrs:{item:e},on:{count:t.calc}})}))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total,expression:"total"}],staticClass:"settle-wrapper"},[s("settle",{attrs:{price:t.price,total:t.total},on:{submit:t.submit}})],1)],1),t._v(" "),s("category",{directives:[{name:"show",rawName:"v-show",value:t.isShowCategory,expression:"isShowCategory"}],on:{hide:t.hideCategory,query:t.onQueryChange}}),t._v(" "),s("search",{attrs:{isShowSearch:t.isShowSearch},on:{hide:t.hideSearch}}),t._v(" "),s("router-view")],1)])},staticRenderFns:[]};var x=s("VU/8")(k,S,!1,function(t){s("ppph")},"data-v-5a611128",null);e.default=x.exports}});
//# sourceMappingURL=1.929d8fcf26cda090df0d.js.map