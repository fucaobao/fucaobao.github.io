webpackJsonp([27],{B8yc:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("Dd8w"),r=e.n(a),i=e("qwAB"),n=e("Csq2"),c=e("Pl10"),d=e("NYxO"),o=e("T452"),l=e("cJyC"),p={data:function(){return{alertMsg:""}},computed:r()({},Object(d.c)(["shoppingCartItems"]),Object(d.d)(["addressInfo"]),{currentRoute:function(){return this.$router.currentRoute.path},hasAddress:function(){return!!(this.addressInfo.contacts||this.addressInfo.contactNumber||this.addressInfo.address)},isRightAddress:function(){return!!(this.addressInfo.contacts&&this.addressInfo.contactNumber&&this.addressInfo.address)},total:function(){var s=0;for(var t in this.shoppingCartItems)s+=this.shoppingCartItems[t].count;return s},price:function(){var s=0;for(var t in this.shoppingCartItems){var e=this.shoppingCartItems[t];s+=e.price*e.count}return s}}),created:function(){this._getAddress()},methods:r()({back:function(){this.$router.back()},showAlert:function(){this.$refs.alert.show()},_getAddress:function(){var s=this;Object(l.e)().then(function(t){t.errCode===o.b&&t.data&&t.data.length?s.setAddressInfo(t.data[0]):s.setAddressInfo()})},goToAddress:function(){this.$router.push({path:this.currentRoute+"/address"})},_check:function(){return!!this.isRightAddress||(this.alertMsg="请先完善收货地址",this.showAlert(),!1)},submit:function(){var s=this;if(this._check()){var t=[],e=[];for(var a in this.shoppingCartItems){var r=this.shoppingCartItems[a];r.count>0&&(e.push(r.id),t.push({productItemId:r.productItemId,count:r.count}))}Object(l.c)({entries:t,remark:"",merchantShippingAddressId:this.addressInfo.id}).then(function(t){t.errCode===o.b&&(e.forEach(function(s){Object(l.d)(s)}),s.setShoppingCart(),s.$router.push({path:"/purchase/myorder"}))})}}},Object(d.b)(["setAddressInfo","setShoppingCart"])),components:{Settle:n.a,Scroll:i.a,Alert:c.a}},h={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("transition",{attrs:{name:"slide"}},[e("div",{staticClass:"wrapper"},[e("div",{staticClass:"header"},[e("i",{staticClass:"back",on:{click:s.back}}),s._v(" "),e("span",{staticClass:"text"},[s._v("确认订单")])]),s._v(" "),e("div",{staticClass:"content-wrapper"},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.hasAddress,expression:"hasAddress"}],staticClass:"address-wrapper"},[e("div",{staticClass:"icon-wrapper"},[e("i")]),s._v(" "),e("div",{staticClass:"address"},[e("p",{staticClass:"name"},[e("label",[s._v(s._s(s.addressInfo.contacts))]),s._v(" "),e("span",[s._v(s._s(s.addressInfo.contactNumber))])]),s._v(" "),e("p",{staticClass:"position"},[s._v(s._s(s.addressInfo.address))])]),s._v(" "),e("div",{staticClass:"forward-wrapper",on:{click:s.goToAddress}},[e("i")])]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.hasAddress,expression:"!hasAddress"}],staticClass:"address-wrapper"},[e("div",{staticClass:"no-address"},[e("em",[s._v("+")]),e("span",[s._v("点击添加收货地址")])]),s._v(" "),e("div",{staticClass:"no-address-forward",on:{click:s.goToAddress}},[e("i")])]),s._v(" "),e("scroll",{staticClass:"content"},[e("ul",{staticClass:"list"},s._l(s.shoppingCartItems,function(t,a){return e("li",{staticClass:"item"},[e("div",{staticClass:"left"},[e("img",{attrs:{src:t.src}})]),s._v(" "),e("div",{staticClass:"right"},[e("p",{staticClass:"name"},[s._v(s._s(t.title))]),s._v(" "),e("div",{staticClass:"desc"},[e("p",[e("label",[s._v("规格：")]),e("span",[s._v(s._s(t.desc))])])]),s._v(" "),e("div",{staticClass:"calc"},[e("p",{staticClass:"num"},[e("label",[s._v("x")]),e("span",[s._v(s._s(t.count))])]),s._v(" "),e("p",{staticClass:"price"},[e("label",[s._v("￥")]),e("span",[s._v(s._s(s._f("formatMoney")(t.price)))])])])])])}))]),s._v(" "),e("div",{staticClass:"settle-wrapper"},[e("settle",{attrs:{price:s.price,total:s.total,confirmText:"确认订单"},on:{submit:s.submit}})],1)],1),s._v(" "),e("router-view"),s._v(" "),e("alert",{ref:"alert",attrs:{message:s.alertMsg}})],1)])},staticRenderFns:[]};var u=e("VU/8")(p,h,!1,function(s){e("hS43")},"data-v-0a34306f",null);t.default=u.exports},hS43:function(s,t){}});
//# sourceMappingURL=27.16ddbaccadd7fa1dc946.js.map